import{h as A,r as d,j as e,A as O,k as a,X as _}from"./index-BlD2Obq6.js";import{M as B,S as $,H as F}from"./send-DyN1i_5y.js";import{C as P,T as q}from"./trash-2-DHU21Elo.js";import{P as J}from"./pen-square-DC_L7EPK.js";const Y=()=>{const{data:x,addItem:w,updateItem:g,deleteItem:y}=A(),[m,h]=d.useState({name:"",message:""}),[s,j]=d.useState(""),[S,c]=d.useState(!1),[C,f]=d.useState(null),[b,p]=d.useState("");d.useEffect(()=>{const t=localStorage.getItem("guestbook_username");t?(j(t),h(n=>({...n,name:t}))):c(!0)},[]),d.useEffect(()=>{s.trim()&&(localStorage.setItem("guestbook_username",s.trim()),h(t=>({...t,name:s.trim()})))},[s]);const k=()=>{let t=localStorage.getItem("guestbook_userId");return t||(t="user_"+Math.random().toString(36).substr(2,9),localStorage.setItem("guestbook_userId",t)),t},N=()=>{try{const t=localStorage.getItem("guestbook_liked");return t?JSON.parse(t):[]}catch(t){return console.error("Error parsing liked entries:",t),[]}},E=t=>N().includes(t),v=t=>{const n=k();return t.userId===n},I=t=>{if(!s){c(!0),alert("Vui lÃ²ng nháº­p tÃªn trÆ°á»›c khi thÃ­ch tin nháº¯n!");return}const n=N(),i=n.includes(t),r=x.guestbook.find(o=>o.id===t);if(!r)return;const l=typeof r.likes=="number"?r.likes:0;if(i){const o=n.filter(u=>u!==t);localStorage.setItem("guestbook_liked",JSON.stringify(o)),g("guestbook",t,{likes:Math.max(0,l-1)})}else n.push(t),localStorage.setItem("guestbook_liked",JSON.stringify(n)),g("guestbook",t,{likes:l+1})},T=t=>{const n=x.guestbook.find(i=>i.id===t);if(n){if(!v(n)){alert("Báº¡n chá»‰ cÃ³ thá»ƒ xÃ³a bÃ i viáº¿t cá»§a chÃ­nh mÃ¬nh!");return}window.confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a tin nháº¯n nÃ y?")&&y("guestbook",t)}},z=t=>{if(!v(t)){alert("Báº¡n chá»‰ cÃ³ thá»ƒ chá»‰nh sá»­a bÃ i viáº¿t cá»§a chÃ­nh mÃ¬nh!");return}f(t.id),p(t.message)},H=t=>{b.trim()&&(g("guestbook",t,{message:b.trim(),updatedAt:new Date().toISOString()}),f(null),p(""))},V=()=>{f(null),p("")},L=t=>{if(t.preventDefault(),!s){c(!0),alert("Vui lÃ²ng nháº­p tÃªn trÆ°á»›c khi gá»­i tin nháº¯n!");return}m.message.trim()?(w("guestbook",{name:s,message:m.message.trim(),date:new Date().toISOString().split("T")[0],likes:0,createdAt:new Date().toISOString(),userId:k()}),h(n=>({...n,message:""}))):alert("Vui lÃ²ng nháº­p ná»™i dung tin nháº¯n!")},M=t=>{if(!t)return"Vá»«a xong";try{const n=new Date(t),r=new Date-n,l=Math.floor(r/6e4),o=Math.floor(r/36e5),u=Math.floor(r/864e5);return l<1?"Vá»«a xong":l<60?`${l} phÃºt trÆ°á»›c`:o<24?`${o} giá» trÆ°á»›c`:u<7?`${u} ngÃ y trÆ°á»›c`:n.toLocaleDateString("vi-VN")}catch{return"Vá»«a xong"}},D=t=>{const n=t==null?void 0:t.likes;if(typeof n=="number")return n;if(typeof n=="string"){const i=parseInt(n,10);return isNaN(i)?0:i}return 0};return e.jsxs("div",{className:"min-h-screen pt-24 px-4 pb-20",children:[e.jsx(O,{children:S&&e.jsxs(e.Fragment,{children:[e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50"}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(a.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative glass rounded-2xl p-8 max-w-md w-full",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{className:"font-fredoka text-2xl text-lavender mb-4 text-center",children:"ðŸ‘‹ ChÃ o báº¡n!"}),e.jsx("p",{className:"font-nunito text-mint mb-6 text-center",children:"Nháº­p tÃªn cá»§a báº¡n Ä‘á»ƒ tham gia vÃ o guestbook"}),e.jsx("input",{type:"text",value:s,onChange:t=>j(t.target.value),placeholder:"TÃªn cá»§a báº¡n...",className:"w-full px-4 py-3 rounded-lg border-2 border-lavender/30 bg-dark/50 text-lavender font-nunito mb-4 outline-none",autoFocus:!0}),e.jsx("button",{onClick:()=>{s.trim()&&c(!1)},className:"w-full bg-gradient-to-r from-lavender to-pink text-white font-fredoka py-3 rounded-full",children:"Báº¯t Ä‘áº§u"})]})})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(a.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("h1",{className:"font-baloo text-6xl font-bold text-lavender neon-text mb-4",children:"âœï¸ Guestbook"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx("p",{className:"font-pacifico text-2xl text-mint",children:"Leave your mark on our journey"}),s&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1 rounded-full bg-lavender/20",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-lavender/30 flex items-center justify-center",children:s.charAt(0).toUpperCase()}),e.jsx("span",{className:"font-nunito text-lavender",children:s}),e.jsx("button",{onClick:()=>c(!0),className:"text-lavender/60 hover:text-lavender",title:"Äá»•i tÃªn",children:e.jsx(B,{size:16})})]})]})]}),e.jsx(a.form,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},onSubmit:L,className:"glass rounded-3xl p-8 mb-12 blur-shadow",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"font-nunito text-mint font-bold",children:"TÃªn cá»§a báº¡n:"}),!s&&e.jsx("button",{type:"button",onClick:()=>c(!0),className:"text-sm text-amber-300 hover:text-amber-200 underline",children:"Nháº­p tÃªn"})]}),e.jsx("div",{className:`px-6 py-4 rounded-full border-2 ${s?"border-lavender/30 text-lavender":"border-amber-400/30 text-amber-400"} bg-transparent font-nunito text-lg`,children:s||"Vui lÃ²ng nháº­p tÃªn cá»§a báº¡n..."}),e.jsx("textarea",{placeholder:"Your Message ðŸ’œ (Tin nháº¯n cá»§a báº¡n...)",value:m.message,onChange:t=>h({...m,message:t.target.value}),rows:"4",className:"w-full px-6 py-4 rounded-3xl glass border-2 border-lavender/30 focus:border-lavender bg-transparent text-lavender font-nunito text-lg outline-none resize-none transition-all duration-300",required:!0}),e.jsxs(a.button,{type:"submit",disabled:!s,whileHover:{scale:1.05},whileTap:{scale:.95},className:`w-full font-fredoka font-bold text-xl py-4 rounded-full flex items-center justify-center gap-3 ${s?"bg-gradient-to-r from-lavender to-pink text-white shadow-lg shadow-lavender/50":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,children:[e.jsx($,{size:24}),"Send Message"]})]})}),e.jsx("div",{className:"space-y-6",children:x.guestbook&&x.guestbook.length>0?x.guestbook.slice().reverse().map((t,n)=>{const i=E(t.id),r=D(t),l=v(t),o=C===t.id;return e.jsxs(a.div,{initial:{opacity:0,x:n%2===0?-50:50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:n*.1},className:"glass rounded-3xl p-6 relative overflow-hidden group blur-shadow",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-lavender/10 via-pink/10 to-mint/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-pacifico text-2xl text-lavender",children:t.name}),l&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-lavender/20 text-lavender",children:"Báº¡n"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsx("p",{className:"font-nunito text-sm text-mint",children:t.date}),t.createdAt&&e.jsx("span",{className:"font-nunito text-xs text-lavender/60",children:M(t.createdAt)}),t.updatedAt&&e.jsx("span",{className:"font-nunito text-xs text-amber-400",children:"(ÄÃ£ chá»‰nh sá»­a)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(a.button,{onClick:()=>I(t.id),whileHover:{scale:1.2},whileTap:{scale:.9},className:`flex items-center gap-2 transition-all duration-200 ${i?"text-pink transform scale-110":"text-pink/60 hover:text-pink hover:scale-105"}`,title:i?"Bá» thÃ­ch":"ThÃ­ch",children:[e.jsx(F,{size:24,fill:i?"currentColor":"none",className:i?"animate-pulse":""}),e.jsx("span",{className:"font-nunito font-bold",children:r})]}),l&&e.jsx("div",{className:"flex items-center gap-1 ml-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(a.button,{onClick:()=>H(t.id),whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-1 rounded-full bg-green-500/20 text-green-400 hover:bg-green-500/30",title:"LÆ°u",children:e.jsx(P,{size:16})}),e.jsx(a.button,{onClick:V,whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-1 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30",title:"Há»§y",children:e.jsx(_,{size:16})})]}):e.jsxs(e.Fragment,{children:[e.jsx(a.button,{onClick:()=>z(t),whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-1 rounded-full bg-lavender/20 text-lavender hover:bg-lavender/30 opacity-0 group-hover:opacity-100 transition-opacity",title:"Chá»‰nh sá»­a",children:e.jsx(J,{size:16})}),e.jsx(a.button,{onClick:()=>T(t.id),whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-1 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30 opacity-0 group-hover:opacity-100 transition-opacity",title:"XÃ³a",children:e.jsx(q,{size:16})})]})})]})]}),o?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:b,onChange:u=>p(u.target.value),rows:"3",className:"w-full px-4 py-3 rounded-xl border-2 border-lavender/50 bg-dark/50 text-lavender font-nunito outline-none resize-none",autoFocus:!0}),e.jsx("p",{className:"text-xs text-amber-300",children:"Chá»‰nh sá»­a tin nháº¯n cá»§a báº¡n..."})]}):e.jsx("p",{className:"font-nunito text-lg text-mint leading-relaxed whitespace-pre-wrap",children:t.message})]}),e.jsx(a.div,{animate:{y:[-5,5,-5],rotate:[-10,10,-10]},transition:{duration:4,repeat:1/0},className:"absolute bottom-4 right-4 text-3xl opacity-50 pointer-events-none",children:["ðŸ’œ","â­","âœ¨","ðŸŒ™"][n%4]})]},t.id)}):e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},className:"glass rounded-3xl p-12 text-center",children:[e.jsx("div",{className:"text-8xl mb-6",children:"ðŸ“"}),e.jsx("h3",{className:"font-fredoka text-3xl text-lavender mb-4",children:"ChÆ°a cÃ³ tin nháº¯n nÃ o"}),e.jsx("p",{className:"font-nunito text-lg text-mint mb-6",children:"HÃ£y lÃ  ngÆ°á»i Ä‘áº§u tiÃªn Ä‘á»ƒ láº¡i lá»i nháº¯n!"}),e.jsx(a.button,{onClick:()=>{var t;if(!s){c(!0),alert("Vui lÃ²ng nháº­p tÃªn trÆ°á»›c khi gá»­i tin nháº¯n!");return}(t=document.querySelector("textarea"))==null||t.focus()},whileHover:{scale:1.05},whileTap:{scale:.95},className:"glass px-8 py-3 rounded-full text-lavender font-nunito font-bold border-2 border-lavender hover:bg-lavender hover:text-dark transition-all duration-300",children:"Viáº¿t tin nháº¯n Ä‘áº§u tiÃªn"})]})})]})]})};export{Y as default};
